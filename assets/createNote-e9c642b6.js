import{T as b,m as w,r,u as I,N as T,U as _,V as M,j as t,n as g,W as y,X as k}from"./index-180f50e7.js";import{d as E}from"./ArrowBackIos-9d204c5d.js";import{B as C}from"./Button-3e529512.js";import{F as P}from"./message-19cda204.js";import{T as j}from"./TextField-ef374eb9.js";import"./createSvgIcon-b5137e21.js";import"./Paper-57c57c45.js";import"./ButtonGroupContext-0b3a7706.js";function R(){const{recordId:l}=b(),a=w(),d=l==="create",i=parseInt(l),[s,f]=r.useState(null),[n,u]=r.useState(null),o=I(),v=async()=>{if(s&&n){const e=new Date;if(d)await y({title:s,content:n,created_at:e,modified_at:e,versions:[]});else{const{title:c,content:m,versions:p=[],...N}=await _(i);p.push({title:c,content:m,modified_at:e}),await k({...N,title:s,content:n,modified_at:e,versions:p})}x()}s===null&&f(""),n===null&&u("")},x=r.useCallback(()=>{a(T)},[a]),h=r.useCallback(async()=>{const e=await _(i);e||a(M);const{title:c,content:m}=e;f(c),u(m)},[a,i]);return r.useEffect(()=>{const e=l===`${i}`;!e&&!d&&a(M),e&&h()},[h,d,a,i,l]),t.jsxs(t.Fragment,{children:[t.jsxs(g,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(C,{onClick:x,children:t.jsx(E,{})}),t.jsx(g,{sx:{flex:"1 1 0"},children:d?o.formatMessage({defaultMessage:"Create note",id:"create_note"}):o.formatMessage({defaultMessage:"Edit note",id:"edit_note"})}),t.jsx(C,{onClick:v,variant:"contained",size:"small",children:t.jsx(P,{defaultMessage:"Add",id:"add"})})]}),t.jsxs(g,{sx:{flex:"1 1 0",overflow:"hidden auto"},children:[t.jsx(j,{autoComplete:"off",required:!0,margin:"dense",id:"title",label:o.formatMessage({defaultMessage:"title",id:"add_note_title"}),error:s==="",helperText:o.formatMessage({defaultMessage:"Please enter the title of the note",id:"add_note_title_helper"}),type:"text",value:s??"",onChange:e=>f(e.target.value),fullWidth:!0,variant:"standard"}),t.jsx(j,{required:!0,autoComplete:"off",margin:"dense",id:"content",label:o.formatMessage({defaultMessage:"content",id:"add_note_content"}),error:n==="",helperText:o.formatMessage({defaultMessage:"Please enter the content of the note",id:"add_note_content_helper"}),type:"text",value:n??"",onChange:e=>u(e.target.value),fullWidth:!0,multiline:!0,variant:"standard"})]})]})}export{R as default};
