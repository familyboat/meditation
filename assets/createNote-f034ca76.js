import{$ as b,m as w,r,u as I,N as y,a0 as _,a1 as M,j as t,v as g,a2 as T,a3 as k}from"./index-c5e3b550.js";import{d as E}from"./ArrowBackIos-8ce223af.js";import{B as v}from"./Button-ac191a12.js";import{F as P}from"./message-8ae6668f.js";import{T as C}from"./TextField-f94dec9f.js";import"./createSvgIcon-a07ff00a.js";import"./Paper-3fb5e6ac.js";import"./ButtonGroupContext-f62b1566.js";function A(){const{recordId:l}=b(),a=w(),d=l==="create",i=parseInt(l),[s,f]=r.useState(null),[n,u]=r.useState(null),o=I(),j=async()=>{if(s&&n){const e=new Date;if(d)await T({title:s,content:n,created_at:e,modified_at:e,versions:[]});else{const{title:c,content:m,versions:p=[],...N}=await _(i);p.push({title:c,content:m,modified_at:e}),await k({...N,title:s,content:n,modified_at:e,versions:p})}x()}s===null&&f(""),n===null&&u("")},x=r.useCallback(()=>{a(y)},[a]),h=r.useCallback(async()=>{const e=await _(i);e||a(M);const{title:c,content:m}=e;f(c),u(m)},[a,i]);return r.useEffect(()=>{const e=l===`${i}`;!e&&!d&&a(M),e&&h()},[h,d,a,i,l]),t.jsxs(t.Fragment,{children:[t.jsxs(g,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(v,{onClick:x,children:t.jsx(E,{})}),t.jsx(g,{sx:{flex:"1 1 0"},children:d?o.formatMessage({defaultMessage:"Create note",id:"create_note"}):o.formatMessage({defaultMessage:"Edit note",id:"edit_note"})}),t.jsx(v,{onClick:j,variant:"contained",size:"small",children:t.jsx(P,{defaultMessage:"Add",id:"add"})})]}),t.jsxs(g,{sx:{flex:"1 1 0",overflow:"hidden auto"},children:[t.jsx(C,{autoComplete:"off",required:!0,margin:"dense",id:"title",label:o.formatMessage({defaultMessage:"title",id:"add_note_title"}),error:s==="",helperText:o.formatMessage({defaultMessage:"Please enter the title of the note",id:"add_note_title_helper"}),type:"text",value:s??"",onChange:e=>f(e.target.value),fullWidth:!0,variant:"standard"}),t.jsx(C,{required:!0,autoComplete:"off",margin:"dense",id:"content",label:o.formatMessage({defaultMessage:"content",id:"add_note_content"}),error:n==="",helperText:o.formatMessage({defaultMessage:"Please enter the content of the note",id:"add_note_content_helper"}),type:"text",value:n??"",onChange:e=>u(e.target.value),fullWidth:!0,multiline:!0,variant:"standard"})]})]})}export{A as default};
